/*! angular-gantt 11-11-2014 */

"use strict";angular.module("gantt.bounds.templates",[]).run(["$templateCache",function(a){a.put("plugins/bounds/default.taskBounds.tmpl.html",'<div ng-show="bounds && isTaskMouseOver" class="gantt-task-bounds" ng-style="getCss()" ng-class="getClass()">\n</div>\n')}]),angular.module("gantt.movable.templates",[]).run(["$templateCache",function(){}]),angular.module("gantt.sortable.templates",[]).run(["$templateCache",function(){}]),angular.module("gantt.tooltips.templates",[]).run(["$templateCache",function(a){a.put("plugins/tooltips/default.tooltip.tmpl.html",'<div ng-show="showTooltips" class="gantt-task-info" ng-cloak ng-style="css">\n    <div class="gantt-task-info-content">\n        {{ task.name }}</br>\n        <small>\n            {{\n            task.isMilestone === true && (task.getFromLabel()) || (task.getFromLabel() + \' - \' + task.getToLabel());\n            }}\n        </small>\n    </div>\n</div>\n')}]),angular.module("gantt.bounds",["gantt","gantt.bounds.templates"]).directive("ganttBounds",["$compile","$timeout",function(a,b){return{restrict:"E",require:"^gantt",link:function(c,d,e,f){var g=f.gantt.api;g.directives.on.new(c,function(c,d,e){"ganttTask"===c&&b(function(){e.append(a('<gantt-task-bounds ng-model="task"></gantt-bounds>')(d))})})}}}]),angular.module("gantt.movable",["gantt"]).directive("ganttMovable",["ganttMouseButton","ganttMouseOffset","ganttDebounce","ganttSmartEvent","ganttMovableOptions","$window","$document","$timeout",function(a,b,c,d,e,f,g,h){return{restrict:"E",require:"^gantt",scope:{allowMoving:"=?",allowResizing:"=?",allowRowSwitching:"=?"},link:function(i,j,k,l){var m=l.gantt.api;if(m.registerEvent("tasks","move"),m.registerEvent("tasks","moveBegin"),m.registerEvent("tasks","moveEnd"),m.registerEvent("tasks","resize"),m.registerEvent("tasks","resizeBegin"),m.registerEvent("tasks","resizeEnd"),m.registerEvent("tasks","change"),i.options&&"object"==typeof i.options.movable)for(var n in i.options.movable)i[n]=i.options[n];e.initialize(i),m.directives.on.new(i,function(e,j,k){if("ganttTaskContent"===e){var l,m,n,o=5,p=3,q=15,r=5,s=angular.element(f),t=j.row.$element,u=j.row.rowsManager.gantt.body.$element,v=j.row.rowsManager.gantt.scroll.$element,w=!1;k.bind("mousedown",function(c){j.$apply(function(){var d=C(c);if(""!==d&&1===a.getButton(c)){var e=b.getOffsetForElement(u[0],c).x;E(d,e,c)}})}),k.bind("mousemove",c(function(a){var b=C(a);""===b||!j.task.isMoving&&"M"===b?k.css("cursor",""):k.css("cursor",D(b))},5));var x=function(a,b){j.task.isMoving!==!1&&(y(a,b),z(a,b))},y=function(a,c){var d=b.getOffsetForElement(u[0],c);j.task.mouseOffsetX=d.x;var e=d.x;if("M"===a){if(i.allowRowSwitching){var f=B(d.y);void 0!==f&&j.task.row.id!==f.id&&f.moveTaskToRow(j.task)}i.allowMoving&&(e-=l,"truncate"!==j.taskOutOfRange&&(0>e?e=0:e+j.task.width>=j.gantt.width&&(e=j.gantt.width-j.task.width)),j.task.moveTo(e),j.row.rowsManager.gantt.api.tasks.raise.move(j.task))}else"E"===a?("truncate"!==j.taskOutOfRange&&(e<j.task.left?e=j.task.left:e>j.gantt.width&&(e=j.gantt.width)),j.task.setTo(e),j.row.rowsManager.gantt.api.tasks.raise.resize(j.task)):("truncate"!==j.taskOutOfRange&&(e>j.task.left+j.task.width?e=j.task.left+j.task.width:0>e&&(e=0)),j.task.setFrom(e),j.row.rowsManager.gantt.api.tasks.raise.resize(j.task));w=!0},z=function(a,c){var d=b.getOffsetForElement(u[0],c),e=v[0].scrollLeft,f=!1;if(d.x<m)d.x<=e+r&&(d.x-=q,f=!0,j.row.rowsManager.gantt.api.scroll.left(q));else{var g=v[0].offsetWidth,i=e+g;d.x>=i-r&&(d.x+=q,f=!0,j.row.rowsManager.gantt.api.scroll.right(q))}f&&(n=h(function(){x(a,c)},100,!0))},A=function(){void 0!==n&&(h.cancel(n),n=void 0)},B=function(a){if(a>=t[0].offsetTop&&a<=t[0].offsetTop+t[0].offsetHeight)return j.task.row;var b=[];angular.forEach(j.task.row.rowsManager.rows,function(a){a.hidden||b.push(a)});var c=u[0].offsetHeight/b.length,d=Math.floor(a/c);return b[d]},C=function(a){var c=b.getOffset(a).x,d=0;return i.allowResizing&&(d=k[0].offsetWidth<10?p:o),i.allowResizing&&c>k[0].offsetWidth-d?"E":i.allowResizing&&d>c?"W":(i.allowMoving||i.allowRowSwitching)&&c>=d&&c<=k[0].offsetWidth-d?"M":""},D=function(a){switch(a){case"E":return"e-resize";case"W":return"w-resize";case"M":return"move"}},E=function(a,b){j.task.isMoving||("M"===a?j.row.rowsManager.gantt.api.tasks.raise.moveBegin(j.task):j.row.rowsManager.gantt.api.tasks.raise.resizeBegin(j.task)),w=!1,j.task.moveMode=a,j.task.isMoving=!0,m=b,l=b-j.task.modelLeft;var e=c(function(b){j.task.isMoving&&(A(),x(a,b))},5);d(j,s,"mousemove",e).bind(),d(j,s,"mouseup",function(a){j.$apply(function(){s.unbind("mousemove",e),F(a)})}).bindOnce(),k.css("cursor",D(a)),angular.element(g[0].body).css({"-moz-user-select":"-moz-none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none",cursor:D(a)})},F=function(){j.task.isMoving=!1,A(),k.css("cursor",""),angular.element(g[0].body).css({"-moz-user-select":"","-webkit-user-select":"","-ms-user-select":"","user-select":"",cursor:""}),"M"===j.task.moveMode?j.row.rowsManager.gantt.api.tasks.raise.moveEnd(j.task):j.row.rowsManager.gantt.api.tasks.raise.resizeEnd(j.task),j.task.moveMode=void 0,w===!0&&(w=!1,j.task.row.sortTasks(),j.row.rowsManager.gantt.api.tasks.raise.change(j.task))};j.task.isCreating?(delete j.task.isCreating,E("E",j.task.mouseOffsetX)):j.task.isMoving&&E("M",j.task.mouseOffsetX)}})}}}]),angular.module("gantt.sortable",["gantt"]).directive("ganttSortable",["$document",function(a){return{restrict:"E",require:"^gantt",scope:{enabled:"=?"},link:function(b,c,d,e){var f=e.gantt.api;void 0===b.enabled&&(b.enabled=!0),f.directives.on.new(b,function(c,d,e){if("ganttRowLabel"===c){e.bind("mousedown",function(){if(b.enabled){g();var c=function(){d.$apply(function(){angular.element(a[0].body).unbind("mouseup",c),h()})};angular.element(a[0].body).bind("mouseup",c)}}),e.bind("mousemove",function(c){if(f()){var e=a[0].elementFromPoint(c.clientX,c.clientY);e=angular.element(e);var g=e.scope().row;g.id!==b.startRow.id&&d.$apply(function(){d.row.rowsManager.swapRows(g,b.startRow)})}});var f=function(){return void 0!==b.startRow&&!angular.equals(d.row,b.startRow)},g=function(){b.startRow=d.row,e.css("cursor","move"),angular.element(a[0].body).css({"-moz-user-select":"-moz-none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none",cursor:"no-drop"})},h=function(){b.startRow=void 0,e.css("cursor","pointer"),angular.element(a[0].body).css({"-moz-user-select":"","-webkit-user-select":"","-ms-user-select":"","user-select":"",cursor:"auto"})}}})}}}]),angular.module("gantt.tooltips",["gantt","gantt.tooltips.templates"]).directive("ganttTooltips",["$compile","$timeout",function(a,b){return{restrict:"E",require:"^gantt",link:function(c,d,e,f){var g=f.gantt.api;g.directives.on.new(c,function(c,d,e){"ganttTask"===c&&b(function(){e.prepend(a('<gantt-tooltip ng-model="task"></gantt-tooltip>')(d))})})}}}]),gantt.directive("ganttTaskBounds",[function(){return{restrict:"E",templateUrl:function(a,b){return void 0===b.templateUrl?"plugins/bounds/default.taskBounds.tmpl.html":b.templateUrl},replace:!0,scope:!0,controller:["$scope","$element",function(a,b){var c={};a.$watchGroup(["task.est","task.lct"],function(){void 0!==a.task.est&&void 0!==a.task.lct?(a.bounds={},a.bounds.left=a.task.rowsManager.gantt.getPositionByDate(a.task.est),a.bounds.width=a.task.rowsManager.gantt.getPositionByDate(a.task.lct)-a.bounds.left):a.bounds=void 0}),a.task.$element.bind("mouseenter",function(){a.$apply(function(){a.isTaskMouseOver=!0})}),a.task.$element.bind("mouseleave",function(){a.$apply(function(){a.isTaskMouseOver=!1})}),a.getCss=function(){return void 0!==a.bounds&&(c.width=a.bounds.width+"px",c.left=a.task.isMilestone===!0||0===a.task.width?a.bounds.left-(a.task.left-.3)+"px":a.bounds.left-a.task.left+"px"),c},a.getClass=function(){return void 0===a.task.est||void 0===a.task.lct?"gantt-task-bounds-in":a.task.est>a.task.from?"gantt-task-bounds-out":a.task.lct<a.task.to?"gantt-task-bounds-out":"gantt-task-bounds-in"},a.task.rowsManager.gantt.api.directives.raise.new("ganttBounds",a,b),a.$on("$destroy",function(){a.task.rowsManager.gantt.api.directives.raise.destroy("ganttBounds",a,b)})}]}}]),angular.module("gantt.movable").factory("ganttMovableOptions",[function(){return{initialize:function(a){return a.allowMoving=void 0!==a.allowMoving?!!a.allowMoving:!0,a.allowResizing=void 0!==a.allowResizing?!!a.allowResizing:!0,a.allowRowSwitching=void 0!==a.allowRowSwitching?!!a.allowRowSwitching:!0,a}}}]),angular.module("gantt.tooltips").directive("ganttTooltip",["$timeout","$document","ganttDebounce","ganttSmartEvent",function(a,b,c,d){return{restrict:"E",templateUrl:function(a,b){return void 0===b.templateUrl?"plugins/tooltips/default.tooltip.tmpl.html":b.templateUrl},scope:!0,replace:!0,controller:["$scope","$element",function(e,f){var g,h,i=angular.element(b[0].body),j=f.parent();e.css={},e.$watch("isTaskMouseOver",function(b){g&&a.cancel(g),b===!0?g=a(function(){m(h)},500):e.task.isMoving||o()}),e.task.$element.bind("mousemove",function(a){h=a.clientX}),e.task.$element.bind("mouseenter",function(a){e.$apply(function(){e.mouseEnterX=a.clientX,e.isTaskMouseOver=!0})}),e.task.$element.bind("mouseleave",function(){e.$apply(function(){e.mouseEnterX=void 0,e.isTaskMouseOver=!1})});var k=d(e,i,"mousemove",c(function(a){n(a.clientX)},5,!1));e.$watch("task.isMoving",function(a){a===!0?k.bind():a===!1&&(k.unbind(),o())});var l=function(){var a=b[0];return a.documentElement.clientWidth||a.documentElement.getElementById("body")[0].clientWidth},m=function(b){a(function(){n(b),e.css.top=j[0].getBoundingClientRect().top+"px",e.css.marginTop=-f[0].offsetHeight-8+"px",e.css.opacity=1,e.css["z-index"]=10},0,!0)},n=function(a){a+f[0].offsetWidth>l()?(e.css.left=a+20-f[0].offsetWidth+"px",f.addClass("gantt-task-infoArrowR"),f.removeClass("gantt-task-infoArrow")):(e.css.left=a-20+"px",f.addClass("gantt-task-infoArrow"),f.removeClass("gantt-task-infoArrowR"))},o=function(){e.css.opacity=0,e.css["z-index"]=-10};e.gantt.api.directives.raise.new("ganttTooltip",e,f),e.$on("$destroy",function(){e.gantt.api.directives.raise.destroy("ganttTooltip",e,f)})}]}}]);
//# sourceMappingURL=angular-gantt-plugins.min.js.map